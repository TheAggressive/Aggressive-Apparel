/**
 * Size Guide Modal Styles
 *
 * @package Aggressive_Apparel
 * @since 1.17.0
 */

/* -----------------------------------------------
 * Trigger button
 * ----------------------------------------------- */

.aggressive-apparel-size-guide__trigger {
	display: inline-flex;
	align-items: center;
	gap: 0.4em;
	margin-bottom: 1rem;
	padding: 0.5em 1em;
	border: none;
	border-radius: 0;
	background: none;
	color: currentcolor;
	font-size: 0.75rem;
	font-weight: 700;
	text-transform: uppercase;
	letter-spacing: 0.06em;
	text-decoration: none;
	cursor: pointer;
	transition: background-color 0.15s ease;

	&::before {
		content: "";
		display: inline-block;
		width: 1.25rem;
		height: 1.25rem;
		margin-right: 0.25rem;
		background-color: currentcolor;
		mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Cpath fill-rule='evenodd' d='M18.984 5.329L14.671 1.016 1.016 14.671l4.313 4.313L18.984 5.329zm-3.594-5.031a1.016 1.016 0 00-1.437 0L.298 13.953a1.016 1.016 0 000 1.437l4.312 4.312a1.016 1.016 0 001.437 0L19.702 6.047a1.016 1.016 0 000-1.437L15.39.298z'/%3E%3Cpath d='M11.786 2.671a.508.508 0 01.719 0l1.919 1.918a.508.508 0 01-.72.719l-1.918-1.92a.508.508 0 010-.717zM8.939 5.363a.508.508 0 01.719 0l1.918 1.919a.508.508 0 01-.718.719L8.939 6.082a.508.508 0 010-.719zM6.243 8.207a.508.508 0 01.719 0l1.919 1.919a.508.508 0 01-.72.719L6.244 8.926a.508.508 0 010-.719zM3.373 10.878a.508.508 0 01.719 0l1.918 1.918a.508.508 0 01-.718.719L3.373 11.596a.508.508 0 010-.718z'/%3E%3C/svg%3E");
		mask-size: contain;
		mask-repeat: no-repeat;
	}

	&:hover,
	&:focus-visible {
		background-color: color-mix(in oklch, currentcolor 6%, transparent);
	}

	@media (prefers-reduced-motion: reduce) {
		transition: none;
	}
}

/* -----------------------------------------------
 * Overlay
 * ----------------------------------------------- */

.aggressive-apparel-size-guide__overlay {
	position: fixed;
	inset: 0;
	z-index: 100000;
	display: flex;
	align-items: center;
	justify-content: center;

	&[hidden] {
		display: none;
	}
}

.aggressive-apparel-size-guide__backdrop {
	position: absolute;
	inset: 0;
	background-color: rgb(0 0 0 / 0%);
	backdrop-filter: blur(0);
	transition:
		background-color 0.3s cubic-bezier(0.4, 0, 0.2, 1),
		backdrop-filter 0.3s cubic-bezier(0.4, 0, 0.2, 1);

	.is-open & {
		background-color: rgb(0 0 0 / 80%);
		backdrop-filter: blur(4px);
	}

	@media (prefers-reduced-motion: reduce) {
		transition: none;
	}
}

/* -----------------------------------------------
 * Modal
 * ----------------------------------------------- */

.aggressive-apparel-size-guide__modal {
	position: relative;
	width: 90vw;
	max-width: 740px;
	max-height: 85vh;
	overflow-y: auto;
	background-color: var(--wp--preset--color--light-dark-white-black, #fff);
	color: var(--wp--preset--color--light-dark-black-white, #000);
	border-radius: 0;
	box-shadow:
		0 25px 50px -12px rgb(0 0 0 / 30%),
		0 0 0 1px rgb(0 0 0 / 5%);

	/* Entrance: slide up + fade in. */
	opacity: 0;
	transform: translateY(20px);
	transition:
		opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1),
		transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);

	.is-open & {
		opacity: 1;
		transform: translateY(0);
	}

	@media (prefers-reduced-motion: reduce) {
		transition: none;
		opacity: 1;
		transform: none;
	}
}

/* -----------------------------------------------
 * Header
 * ----------------------------------------------- */

.aggressive-apparel-size-guide__header {
	display: flex;
	align-items: center;
	justify-content: space-between;
	padding: 1.25rem 1.75rem;
	border-bottom: 1px solid currentcolor;
}

.aggressive-apparel-size-guide__title {
	margin: 0;
	font-size: 1.85rem;
	font-weight: 500;
	text-transform: uppercase;
	letter-spacing: 0.1em;
}

.aggressive-apparel-size-guide__close {
	display: flex;
	align-items: center;
	justify-content: center;
	width: 2.75rem;
	height: 2.75rem;
	padding: 0;
	border: none;
	background: none;
	color: currentcolor;
	font-size: 1.5rem;
	line-height: 1;
	cursor: pointer;
	border-radius: 0;
	transition: opacity 0.15s ease;

	&:hover,
	&:focus-visible {
		opacity: 0.5;
	}

	@media (prefers-reduced-motion: reduce) {
		transition: none;
	}
}

/* -----------------------------------------------
 * Body / table styles
 * ----------------------------------------------- */

.aggressive-apparel-size-guide__body {
	padding: 0;

	/* Paragraphs and headings inside body. */
	p {
		font-size: 0.85rem;
		line-height: 1.6;
		margin-bottom: 1rem;
	}

	h2,
	h3,
	h4 {
		font-size: 0.8rem;
		font-weight: 800;
		text-transform: uppercase;
		letter-spacing: 0.08em;
		margin: 1.5rem 0 0.75rem;
	}

	/* Scrollable table wrapper for mobile. */
	.wp-block-table,
	figure {
		overflow-x: auto;
		-webkit-overflow-scrolling: touch;
    margin-bottom: 0;
	}

	/* Table. */
	table {
		width: 100%;
		min-width: 12rem;
		border-collapse: collapse;
		font-size: 1rem;
		margin-bottom: 0;
    border-bottom: none;
	}

	th,
	td {
		padding: 0.65rem 1rem;
		text-align: center;
		white-space: nowrap;
	}

	th {
		font-weight: 800;
		text-transform: uppercase;
		font-size: 0.65rem;
		letter-spacing: 0.08em;
		background-color: var(--wp--preset--color--light-dark-black-white, #000);
		color: var(--wp--preset--color--light-dark-white-black, #fff);
		border: none;
	}

	/* First column (size labels) bold. */
	td:first-child {
		font-weight: 700;
	}

	/* Zebra stripes. */
	tbody tr:nth-child(even) {
		background-color: color-mix(in oklch, currentcolor 4%, transparent);
	}

	tbody tr {
		transition: background-color 0.1s ease;
	}

	tbody tr:hover {
		background-color: color-mix(in oklch, currentcolor 8%, transparent);
	}

	/* Bottom border on rows instead of full grid. */
	td {
		border: none;
		border-bottom: 1px solid color-mix(in oklch, currentcolor 10%, transparent);
	}

	/* Last row — no bottom border. */
	tbody tr:last-child td {
		border-bottom: none;
	}

	@media (prefers-reduced-motion: reduce) {

		tbody tr {
			transition: none;
		}
	}
}

/* -----------------------------------------------
 * Mobile adjustments
 * ----------------------------------------------- */

@media (width <= 480px) {

	.aggressive-apparel-size-guide__modal {
		width: 95vw;
		max-height: 90vh;
	}

	.aggressive-apparel-size-guide__header {
		padding: 1rem 1.25rem;
	}

	.aggressive-apparel-size-guide__body {
		padding: 1.25rem;
	}
}

/* -----------------------------------------------
 * @starting-style entry animations
 * Smooth entry from display:none → visible.
 * ----------------------------------------------- */
@supports selector(@starting-style) {

	.aggressive-apparel-size-guide__overlay {
		transition: display 0.3s allow-discrete;
	}

	@starting-style {

		.aggressive-apparel-size-guide__overlay.is-open .aggressive-apparel-size-guide__backdrop {
			background-color: rgb(0 0 0 / 0%);
			backdrop-filter: blur(0);
		}

		.aggressive-apparel-size-guide__overlay.is-open .aggressive-apparel-size-guide__modal {
			opacity: 0;
			transform: translateY(20px);
		}
	}
}

/* -----------------------------------------------
 * Table row stagger
 * Rows fade in sequentially on open (opacity-only
 * to avoid scrollbar from transform overflow).
 * ----------------------------------------------- */
@media (prefers-reduced-motion: no-preference) {

	.aggressive-apparel-size-guide__overlay.is-open .aggressive-apparel-size-guide__body tbody tr {
		animation: sg-row-in 0.35s ease both;
		animation-delay: calc(var(--row-index, 0) * 50ms);
	}

	.aggressive-apparel-size-guide__body tbody tr:nth-child(1) { --row-index: 0; }

	.aggressive-apparel-size-guide__body tbody tr:nth-child(2) { --row-index: 1; }

	.aggressive-apparel-size-guide__body tbody tr:nth-child(3) { --row-index: 2; }

	.aggressive-apparel-size-guide__body tbody tr:nth-child(4) { --row-index: 3; }

	.aggressive-apparel-size-guide__body tbody tr:nth-child(5) { --row-index: 4; }

	.aggressive-apparel-size-guide__body tbody tr:nth-child(6) { --row-index: 5; }

	.aggressive-apparel-size-guide__body tbody tr:nth-child(7) { --row-index: 6; }

	.aggressive-apparel-size-guide__body tbody tr:nth-child(8) { --row-index: 7; }

	@keyframes sg-row-in {

		from {
			opacity: 0;
		}

		to {
			opacity: 1;
		}
	}
}

/* -----------------------------------------------
 * Reduced motion — disable all size guide animations
 * ----------------------------------------------- */
@media (prefers-reduced-motion: reduce) {

	.aggressive-apparel-size-guide__backdrop {
		backdrop-filter: none;
		transition: none;
	}

	.aggressive-apparel-size-guide__body tbody tr {
		animation: none !important;
		opacity: 1 !important;
	}
}
